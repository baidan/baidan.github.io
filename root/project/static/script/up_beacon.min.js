"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t,r){var n;if(!e.upLogger){var o={setCookie:function(e,r,n,o,i,a){var c=new Date,s=void 0===n?"":";expires="+new Date(c.getTime()+24*n*60*60*1e3).toUTCString();t.cookie=e+"="+r+s+(null==o?"":" ;path="+o)+(null==i?"":" ;domain="+i)+(1==a?" ; secure":"")},getCookie:function(e){var r=t.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=r?unescape(r[2]):"-"}},i=o.getCookie("b_t_s"),a=(new Date).getTime()-12e11;t.URL.substring(0,t.URL.indexOf("://"));if("-"!=i&&-1!=i.indexOf("t")){var c=i.substring(i.indexOf("t")+1,i.indexOf("x"));a-c>2592e5?(a,o.setCookie("b_t_s",i.replace("t"+c+"x","t"+a+"x"),1e4,"/")):c}else"-"==i?o.setCookie("b_t_s","t"+a+"x",1e4,"/"):o.setCookie("b_t_s",i+"t"+a+"x",1e4,"/"),a;var s={jsName:"up_beacon.js",defaultVer:20150716,jsServer:"www.zjcap.cn/tongji",getVersion:function(){for(var e=this.jsName,r=new RegExp(e+"(\\?(.*))?$"),n=t.getElementsByTagName("script"),o=0;o<n.length;o++){var i=n[o];if(i.src&&i.src.match(r)){var a=i.src.match(r)[2];if(a&&/^[a-zA-Z0-9]+$/.test(a))return a}}return this.defaultVer},setCookie:function(e,r,n,o,i,a){var c=new Date,s=void 0===n?"":";expires="+new Date(c.getTime()+24*n*60*60*1e3).toUTCString();t.cookie=e+"="+r+s+(null==o?"":" ;path="+o)+(null==i?"":" ;domain="+i)+(1==a?" ; secure":"")},getCookie:function(e){var r=t.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=r?unescape(r[2]):"-"},getRand:function(){for(var e=new Date,t=e.getTime()+"-",r=0;r<32;r++)t+=Math.floor(10*Math.random());return t},parseError:function(e){var t="";for(var r in e)t+=r+"="+e[r]+";";return t},getParam:function(e,t){var r=null;if(e)if(s.isString(e)||s.isNumber(e))r=e;else if(s.isObject(e)){var n="";for(var o in e)if(null!=e[o]&&void 0!=e[o]){var i=e[o];s.isArray(i)?i=i.join(","):s.isDate(i)&&(i=i.getTime()),n+=o+"="+encodeURIComponent(i)+"&"}n=n.substring(0,n.length-1),r=n}else s.isArray(e)?s.length&s.length>0&&(r=e.join(",")):r=e.toString();return r||(r="-"),t&&(r=encodeURIComponent(r),r=this.base64encode(r)),r},base64encode:function(e){var t,r,n,o,i,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(n=e.length,r=0,t="";r<n;){if(o=255&e.charCodeAt(r++),r==n){t+=c.charAt(o>>2),t+=c.charAt((3&o)<<4),t+="==";break}if(i=e.charCodeAt(r++),r==n){t+=c.charAt(o>>2),t+=c.charAt((3&o)<<4|(240&i)>>4),t+=c.charAt((15&i)<<2),t+="=";break}a=e.charCodeAt(r++),t+=c.charAt(o>>2),t+=c.charAt((3&o)<<4|(240&i)>>4),t+=c.charAt((15&i)<<2|(192&a)>>6),t+=c.charAt(63&a)}return t},getDomain:function(){return t.URL.substring(t.URL.indexOf("://")+3,t.URL.lastIndexOf("/"))},isString:function(e){return null!=e&&void 0!=e&&"string"==typeof e&&e.constructor==String},isNumber:function(e){return"number"==typeof e&&e.constructor==Number},isDate:function(e){return e&&"object"==(void 0===e?"undefined":_typeof(e))&&e.constructor==Date},isArray:function(e){return e&&"object"==(void 0===e?"undefined":_typeof(e))&&e.constructor==Array},isObject:function(e){return e&&"object"==(void 0===e?"undefined":_typeof(e))&&e.constructor==Object},trim:function(e){return e.replace(/(^\s*)|(\s*$)/,"")}},u=isNaN(u=+s.getCookie("up_beacon_vist_count"))?1:u+1;s.setCookie("up_beacon_vist_count",u);var g=(function(){var e=s.trim(s.getCookie("up_beacon_id"));void 0!=e&&null!=e&&""!=e&&"-"!=e||s.setCookie("up_beacon_id",s.getDomain()+"."+(new Date).getTime())}(),{uvId:"up_beacon_id",memId:"up_dw_track",beaconUrl:s.jsServer+"/trace/a.gif",errorUrl:s.jsServer+"/trace/a.gif",clickUrl:s.jsServer+"/trace/a.gif",pageId:void 0!==n?n:n=s.getRand(),protocol:function(){var e=location.protocol;return"file:"===e&&(e="http:"),e+"//"},tracking:function(){this.beaconLog()},getRefer:function(){var e=t.referrer;e==location.href&&(e="");try{e=""==e?opener.location:e,e=""==e?"-":e}catch(t){e="-"}return e},beaconLog:function(){try{var r=t.URL.indexOf("://"),n=s.getParam(t.URL.substring(r+2)),o=s.getParam(this.getRefer()),i=s.getCookie(this.memId),a=(s.getCookie(this.uvId),s.getCookie("b_t_s")),c={},u="-"==a||-1==a.indexOf("s");"-"!=i&&(c.memId=i),u?(c.subIsNew=1,s.setCookie("b_t_s","-"==a?"s":a+"s",1e4,"/")):c.subIsNew=0;var g=s.getParam(c),f=this.pageId,d=t.title;d.length>25&&(d=d.substring(0,25)),d=encodeURIComponent(d);var l=-1!=navigator.userAgent.indexOf("MSIE")?t.charset:t.characterSet,h=e.screen.width+"*"+e.screen.height,p={logUrl:n,logHisRefer:o,logParams:g,sr:h,title:d,charset:l,pageId:f};this.sendRequest(this.beaconUrl,p)}catch(e){this.sendError(e)}},clickLog:function(e){try{var t=this.pageId;t||(this.pageId=s.getRand(),t=this.pageId);var r=this.authId;r||(r="-"),s.isObject(e)?(e.pageId=t,e.authId=r):s.isString(e)&&e.indexOf("=")>0?e+="&pageId="+t+"&authId="+r:s.isArray(e)?(e.push("pageId="+t),e.push("authId="+r),e=e.join("&")):e={pageId:t,authId:r},this.sendRequest(this.clickUrl,e)}catch(e){this.sendError(e)}},sendRequest:function(e,t){var r="",n=new Date;try{t&&(r=s.getParam(t,!1),r=""==r?r:r+"&");var o="ver="+s.getVersion()+"&time="+n.getTime();e=this.protocol()+e+"?"+r+o;var i=new Image;i.onload=function(){i=null},i.src=e}catch(e){this.sendError(e)}},sendError:function(e){var t=s.parseError(e),r=this.errorUrl+"?type=send&exception="+encodeURIComponent(t.toString()),n=new Image;n.onload=function(){n=null},n.src=this.protocol()+r}});g.tracking(),e.upLogger=g}}(window,document);